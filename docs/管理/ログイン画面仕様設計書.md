# 管理画面 ログイン 画面設計書

---

## 画面名

* 画面ID: CMS_00001
* 画面名: ログイン（管理画面）
* 目的: 管理画面（CMS）へアクセスするために、管理者がメールアドレスとパスワードで認証しログインする。
* 種別: web
* 遷移元:

  * 管理画面URL直アクセス（未ログイン状態）
  * セッション期限切れ／ログアウト後
* 遷移先:

  * ホーム（ダッシュボード）CMS_00002（ログイン成功時） 
  * ログイン（同画面）（エラー時）

---

## 画面概要

* 入力フォーム（メールアドレス／パスワード）とログインボタンで構成
* ログイン成功後は管理画面のホーム（ダッシュボード）へ遷移
* 失敗時は画面内にエラーを表示し、再入力を促す

---

## 画面キャプチャ / ワイヤー

* 管理画面一覧の「ログイン（CMS_00001）」相当（添付の画面一覧に準拠）

---

## 操作概要

* メールアドレスを入力
* パスワードを入力
* 「ログイン」押下で認証を実行
* 認証成功 → ダッシュボード（CMS_00002）へ遷移
* 認証失敗 → エラーメッセージを表示し、入力は維持（パスワードはクリアでも可）

---

## 詳細テーブル

| 部品名称            | 部品の種類      | 型   | 桁数  | IN | OUT | 初期値            | 表示仕様                             | エラーNo | DB情報備考            | テーブル名       | カラム名          |
| :-------------- | :--------- | :-- | :-- | :- | :-- | :------------- | :------------------------------- | :---- | :---------------- | :---------- | :------------ |
| 画面タイトル          | 見出し        | 文字列 | 20  |    | ○   | `ログイン`         | 画面上部に表示                          |       |                   |             |               |
| 説明テキスト          | ラベル        | 文字列 | 100 |    | ○   | `管理画面にログインします` | タイトル直下                           |       |                   |             |               |
| 入力: メールアドレス     | テキストフィールド  | メール | 254 | ○  |     | 空              | placeholder例 `admin@example.com` | E001  | トリムして送信           | admin_users | email         |
| 入力: パスワード       | パスワードフィールド | 文字列 | 128 | ○  |     | 空              | 伏字表示、表示/非表示切替アイコン可               | E002  | 平文保存しない           | admin_users | password_hash |
| チェック: ログイン状態を保持 | チェックボックス   | ブール | 1   | ○  |     | OFF            | 任意（PC向け想定）                       |       | Cookie/セッション方針に依存 |             |               |
| ボタン: ログイン       | ボタン（プライマリ） | -   | -   | ○  |     | 非活性            | 入力が揃うと活性                         | E003  | POSTで認証           |             |               |
| リンク: パスワードを忘れた  | テキストリンク    | -   | -   | ○  |     | 表示             | 任意（運用に合わせて表示）                    |       | メール送信導線           |             |               |
| エラーバナー          | アラート       | 文字列 | 200 |    | ○   | 非表示            | 認証失敗/通信失敗時に表示                    | E900  | 画面上部固定            |             |               |

---

## 挙動仕様

### 入力チェック

* メールアドレス

  * 空欄の場合はエラー表示
  * メール形式でない場合はエラー表示
* パスワード

  * 空欄の場合はエラー表示
  * 文字数不足などルールがある場合はエラー表示（ルールは管理側方針に合わせる）

### ボタンの活性

* メールアドレスとパスワードが両方入力されているときに活性

### 認証処理

* 「ログイン」押下で認証APIを呼ぶ
* 成功時

  * 管理者セッションを発行（Cookie/トークン）
  * CMS_00002（ダッシュボード）へ遷移 
* 失敗時

  * エラーバナー表示（例：`メールアドレスまたはパスワードが違います`）
  * パスワード入力欄はクリア（運用次第）
* 通信失敗時

  * エラーバナー表示（例：`通信に失敗しました。時間をおいて再度お試しください`）

### セキュリティ/運用

* 連続失敗時の制御（運用推奨）

  * 一定回数以上失敗 → 一時的にログイン制限（例：10分）
* セッション期限

  * 期限切れの場合はログイン画面へ戻し、`セッションが切れました` を表示

---

## エラーメッセージ例

* E001: `メールアドレスを入力してください`
* E001: `メールアドレスの形式が正しくありません`
* E002: `パスワードを入力してください`
* E003: `メールアドレスまたはパスワードが違います`
* E900: `通信に失敗しました。時間をおいて再度お試しください`

---

## 備考

* 管理画面は web 前提（CMS機能一覧の種別が web） 
* 将来的に「運営管理者」と「事務所側」などアカウント種別を分ける可能性があるため、認証後にロール（権限）を受け取り、サイドメニュー表示制御に繋げられる設計にしておくのが安全（ダッシュボード構想にも記載あり） 
