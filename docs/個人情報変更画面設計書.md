# 個人情報変更画面 設計書

---

## 画面名

* 画面ID：APP-PROFILE-EDIT-001
* 画面名：個人情報変更
* 目的：ユーザー自身の個人情報を確認・変更できるようにする
* 遷移元：

  * 設定画面（APP-SET-001）
* 遷移先：

  * 設定画面（保存後・キャンセル時）
  * 個人情報変更完了（トースト表示 or 同画面反映）

---

## 画面概要

* 登録済みの個人情報を表示し、編集・保存ができる画面
* 編集可能な項目と編集不可項目を明確に分ける
* 変更は「保存」押下時にまとめて反映

---

## 画面構成

### ヘッダー

* 中央：`個人情報変更`
* 左：戻る（設定画面へ戻る）

---

## 入力フォーム

### 表示名（ニックネーム）

* 入力形式：テキスト
* 初期値：現在の表示名
* 補足：アプリ内で表示される名前

---

### プロフィール画像

* 表示：現在のプロフィール画像
* 操作：

  * 「画像を変更」ボタン
* 挙動：

  * 端末から画像選択（カメラ／ライブラリ）
  * 選択後は即時プレビュー表示

---

### メールアドレス

* 入力形式：メールアドレス
* 初期値：現在のメールアドレス
* 変更時の挙動：

  * 保存時にメール形式チェック
  * 将来的に再認証フローを追加可能な設計

---

### 電話番号

* 入力形式：電話番号
* 初期値：現在の電話番号
* 表示形式例：

  * `090-****-1234`（表示時はマスク、編集時はフル表示でも可）

---

### 生年月日

* 入力形式：日付選択（年月日）
* 初期値：登録済み生年月日
* 補足：年齢制限判定等に利用

---

## 操作エリア

### 保存ボタン

* 表示文言：`保存`
* 初期状態：非活性
* 活性条件：

  * いずれかの項目が変更された場合
  * 入力値がすべて正しい形式である場合
* 押下時：

  * 入力内容を保存
  * 成功時は設定画面へ戻る、またはトースト表示

---

### キャンセル（戻る）

* 戻る操作で未保存の場合：

  * 変更がある場合は確認ダイアログ表示

    * `変更内容を破棄しますか？`

---

## 詳細テーブル

| 部品名称     | 部品の種類  | 型    | 桁数  | IN | OUT | 初期値    | 表示仕様    | DB備考               |
| :------- | :----- | :--- | :-- | :- | :-- | :----- | :------ | :----------------- |
| 画面タイトル   | 見出し    | 文字列  | 20  |    | ○   | 個人情報変更 | 上部中央    |                    |
| 表示名      | テキスト入力 | 文字列  | 30  | ○  | ○   | 現在値    | 任意入力    | users.display_name |
| プロフィール画像 | 画像＋ボタン | -    | -   | ○  | ○   | 現在画像   | 変更ボタン表示 | users.avatar_url   |
| メールアドレス  | メール入力  | 文字列  | 100 | ○  | ○   | 現在値    | メール形式   | users.email        |
| 電話番号     | 電話入力   | 文字列  | 15  | ○  | ○   | 現在値    | 数字・記号   | users.phone        |
| 生年月日     | 日付入力   | date | -   | ○  | ○   | 現在値    | カレンダー選択 | users.birth_date   |
| 保存ボタン    | ボタン    | -    | -   | ○  |     | 非活性    | 変更時のみ活性 |                    |
| 戻るボタン    | アイコン   | -    | -   | ○  |     | -      | 設定へ戻る   |                    |

---

## バリデーション仕様

* 表示名

  * 空文字不可
  * 最大文字数チェック
* メールアドレス

  * メール形式チェック
* 電話番号

  * 数字・ハイフンのみ
* 生年月日

  * 未来日不可

エラー時は項目下にメッセージ表示

---

## 挙動仕様

* 保存成功時：

  * トースト表示：`保存しました`
  * 設定画面へ戻る
* 保存失敗時：

  * トースト表示：`保存に失敗しました`
* 画面再表示時は常に最新情報を取得

---

## 備考

* メールアドレス変更時の再認証（確認メール送信）は将来拡張前提
* プロフィール画像アップロードはサイズ・形式制限を設ける想定
* パスワード変更は本画面では行わず、別画面に分離する
