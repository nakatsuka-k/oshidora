# コメント投稿 画面設計書

（コメント記入画面／コメント送信完了画面）

---

## 画面名

* 画面ID: AXCMS-C-001
* 画面名: コメント投稿
* 目的:
  視聴可能な動画に対してユーザーがコメントを投稿し、送信完了までの一連の流れを提供する。
* 遷移元:

  * 動画詳細（AXCMS-V-002）
  * サブスク加入後の動画詳細（会員限定視聴の導線）
* 遷移先:

  * コメント送信完了画面（同画面内遷移）
  * 動画詳細（送信完了後）

---

## 画面概要

* 本画面はコメント投稿に関する一連の画面を扱う。
* 前半はコメント入力、後半は送信完了の確認表示を行う。
* 完了画面は独立ページではなく、投稿完了状態として遷移・表示される想定とする。

---

## コメント管理方針（反映事項）

* コメントは **作品単位（content_id）で管理・表示**する
* コメント投稿時に **対象エピソードを1つ選択して紐付け（episode_id）**する

  * 一覧表示にはエピソード情報は表示しない（将来拡張用の紐付け）

---

---

## 画面構成

### 1. コメント記入画面

* コメント本文を入力し、送信操作を行う画面
* 動画情報を簡易表示し、どの動画へのコメントかを明示する

追加要素（反映）

* 対象エピソード選択
* 投稿者名入力

### 2. コメント送信完了画面

* コメント送信が正常に完了したことを通知する画面
* 操作導線は動画詳細への戻りを主とする

---

## 操作概要

### コメント記入画面

* コメント本文を入力する
* 対象エピソードを1つ選択する
* 投稿者名を入力する（未入力の場合は「匿名」として送信）
* 「送信」タップでコメント投稿処理を行う
* 「キャンセル」タップで動画詳細へ戻る

### コメント送信完了画面

* 送信完了メッセージを表示する
* 「動画詳細へ戻る」タップで元の動画詳細画面へ遷移する

---

## 詳細テーブル

| 部品名称       | 部品の種類   | 型   | 桁数  | IN | OUT | 初期値    | 表示仕様        | エラーNo    | DB情報備考 | テーブル名    | カラム名  |
| :--------- | :------ | :-- | :-- | :- | :-- | :----- | :---------- | :------- | :----- | :------- | :---- |
| 画面タイトル     | ラベル     | 文字列 | 20  |    | ○   | `コメント` | 画面上部に表示     |          | 固定文言   |          |       |
| 動画タイトル     | テキスト    | 文字列 | 120 |    | ○   | -      | コメント対象作品名   |          | 表示用    | contents | title |
| 対象エピソード選択 | セレクト    | 文字列 | -   | ○  |     | 先頭話   | 1つ必須選択       | C-001-02 | 紐付け    | comments | episode_id |
| 投稿者名入力欄    | テキスト    | 文字列 | 50  | ○  |     | `匿名`  | 未入力時は匿名扱い  |          | 表示/送信用 | comments | author |
| コメント入力欄    | テキストエリア | 文字列 | 500 | ○  |     | 空文字    | 複数行入力可能     | C-001-01 | 改行可    | comments | body  |
| 入力文字数表示    | ラベル     | 数値  | -   |    | ○   | 0      | 「◯ / 500」形式 |          | 表示のみ   |          |       |
| 送信ボタン      | ボタン     | -   | -   | ○  |     | 非活性    | 入力時に活性化     |          | コメント送信 |          |       |
| キャンセルボタン   | ボタン     | -   | -   | ○  |     |        | 動画詳細へ戻る     |          | 遷移のみ   |          |       |
| 完了メッセージ    | テキスト    | 文字列 | 100 |    | ○   | 非表示    | 送信完了時表示     |          | 表示のみ   |          |       |
| 完了サブメッセージ  | テキスト    | 文字列 | 150 |    | ○   | 非表示    | 補足文言        |          | 表示のみ   |          |       |
| 動画詳細へ戻るボタン | ボタン     | -   | -   | ○  |     | 非表示    | 完了時のみ表示     |          | 遷移     |          |       |

---

## 挙動仕様

### コメント記入画面

* 画面表示時に以下を取得する

  * コメント対象作品情報
  * エピソード一覧

* コメント入力

  * 最大文字数を超える入力はできない
  * 未入力状態では送信ボタンは押下できない

* 送信処理

  * 「送信」タップでコメント投稿APIを実行
  * コメント投稿API（PH1）

    * `POST /v1/comments`
    * リクエスト

      ```json
      {
        "contentId": "v1",
        "episodeId": "01",
        "author": "匿名",
        "body": "面白かったです！"
      }
      ```
    * 正常終了時は `201` を返す（管理者確認前のため `status: "pending"`）
  * 正常終了時

    * コメントを保存
    * 入力欄を非表示
    * コメント送信完了画面を表示
  * 失敗時

    * エラーメッセージを表示
    * 入力内容は保持する

* キャンセル

  * 入力内容を破棄し、動画詳細へ戻る

---

### コメント送信完了画面

* 表示内容

  * コメント送信完了メッセージ
  * 補足文言

    * コメント公開前に管理者側のチェックを挟むため、反映までに時間がかかる旨を表示

* 操作

  * 「動画詳細へ戻る」タップで動画詳細画面へ遷移

---

## 備考

* コメント投稿は **ログイン不要**（誰でも投稿可能）
* 不適切投稿対策として、将来的に以下拡張を想定

  * NGワードチェック
  * 通報機能
  * コメント承認制
* コメントは管理者承認後に公開されるため、即時反映はされない
