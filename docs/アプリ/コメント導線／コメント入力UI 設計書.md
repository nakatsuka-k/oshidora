# 動画詳細：コメント表示／コメント投稿UI 設計書（改訂版）

---

## 画面名

* 画面ID: AXCMS-V-002-COM
* 名称: 動画詳細内 コメント表示／コメント投稿UI
* 設置先: 動画詳細（AXCMS-V-002）下部
* 目的:
  作品に紐づくコメントを一覧表示し、購入済みユーザーにコメント投稿導線を提供する。

---

## コメント管理方針（反映事項）

* コメントは **作品単位（content_id）で管理**する

  * 話数（episode）単位では管理しない
* コメント一覧では以下を表示

  * コメント投稿者名
  * コメント内容（50文字以降は「…」で省略）
* **投稿日時は表示しない**
* コメント投稿後は **管理者側チェック（承認）を経て公開**される

  * そのため、反映まで時間がかかる旨を画面上に明示する

---

## UI構成

### 1) コメント一覧セクション

**表示内容**

* 見出し

  * `コメント`
  * 件数表示（承認済みコメントのみをカウント）

* コメント1件の表示要素

  * 投稿者名
  * コメント本文

    * 最大50文字まで表示
    * 51文字以降は `…` で省略
  * 投稿日時：**表示しない**

**表示件数**

* 初期表示：最大10件
* それ以上ある場合

  * 「もっと見る」リンクを表示
  * 押下時の挙動は後続仕様（専用画面 or モーダル）で確定

---

### 2) コメント投稿導線（状態別）

#### A. 常時（投稿可能）

* 入力風UI

  * プレースホルダー: `コメントを書く`
* タップで **コメント記入画面（AXCMS-C-001）** へ遷移

補足（反映）

* コメント投稿は **ログイン不要**（誰でも投稿可能）
* コメント投稿は **購入不要**（誰でも投稿可能）

---

### 3) 投稿後の注意表示（重要）

* コメント投稿後、動画詳細に戻った際に以下を表示

```
※ コメントは管理者の確認後に公開されます。
反映までお時間がかかる場合があります。
```

* この文言は

  * 投稿直後
  * または常時表示（要件次第）
    のどちらかで運用可能

---

## 詳細テーブル（反映後）

| 部品名称     | 部品の種類     | 表示内容    | 備考     |
| -------- | --------- | ------- | ------ |
| コメント見出し  | 見出し       | コメント    | 固定文言   |
| コメント件数   | ラベル       | ◯件      | 承認済みのみ |
| コメント一覧   | リスト       | 投稿者名＋本文 | 作品単位   |
| 投稿者名     | テキスト      | 表示名     | 匿名可    |
| コメント本文   | テキスト      | 最大50文字  | 超過分は省略 |
| 投稿日時     | ―         | 表示しない   | 要件反映   |
| もっと見る    | リンク       | 表示/非表示  | 10件超   |
| コメント入力導線 | 入力風UI     | コメントを書く | 投稿可能時  |
| 購入誘導UI   | 入力風UI＋ボタン | 購入すると〜  | 未購入時   |
| 注意文言     | テキスト      | 管理者確認中  | 投稿後表示  |

---

## 挙動仕様（反映後）

### コメント一覧取得

* 取得条件

  * `content_id`（作品ID）
  * 承認済みフラグ = true

* 取得失敗時

  * コメント一覧は非表示
  * エラーメッセージを表示

---

### コメント投稿後の流れ

1. コメント記入画面で投稿
2. コメントは **非公開状態（pending）** で保存
3. 動画詳細へ戻る
4. 注意文言を表示
5. 管理者承認後、コメント一覧に表示される

---

## コメント投稿時の紐付け（反映）

* コメント投稿時に **対象エピソードを1つ選択して紐付け（episode_id）**する

  * コメント一覧の表示は作品単位のため、一覧上はエピソードは表示しない

---

## DB／状態イメージ（参考）

* comments

  * id
  * content_id
  * user_id
  * body
  * status（pending / approved / rejected）
  * created_at（※表示には使用しない）

---

## 備考

* コメントが即時反映されない設計のため

  * UX的に「送信されたか不安」にならないよう
  * **送信完了画面／文言**は必須
* 将来的に

  * 承認待ちコメントのマイページ表示
  * 管理者コメント返信
    も拡張可能な構成
